{% load thumbnail %}
{% if episode %}
{% with podcast=episode.podcast %}
<div class="fixed bottom-0 z-10 bg-black text-white w-full p-3"
     data-controller="audio"
     data-audio-duration-value="{{ episode.get_duration_in_seconds }}"
     data-audio-current-time-value="{{ current_time|default:0 }}"
     data-audio-progress-url-value="{% url 'episodes:episode_progress' episode.id %}">

  <audio preload="metadata"
         src="{{ episode.media_url }}"
         data-audio-target="audio"
         data-action="progress->audio#progress timeupdate->audio#timeUpdate end->player#stop"></audio>
  <div class="mb-2 md:hidden pr-1">
    <a href="{{ episode.get_absolute_url }}"
       class=""
       title="{{ episode.title }}">{{ episode.title|truncatechars:100 }}</a></div>

  <div class="flex items-stretch">

    {% thumbnail podcast.cover_image "200" format="PNG" crop="center" as img %}
    <img class="object-cover block mr-4 cursor-pointer h-16 w-16 md:h-24 md:w-24 self-center"
         title="{{ podcast.title }}"
         src="{{ img.url }}"
         role="link"
         tag="img"
         width="30"
         height="30">
    {% endthumbnail %}

    <div class="w-full self-start">

      <div class="mb-3 hidden md:flex">

        <a href="{{ episode.get_absolute_url }}"
           title="{{ episode.title }}">{{ episode.title|truncatechars:100 }}</a>
      </div>

      <div class="flex justify-between w-full mb-3">
        <div class="flex justify-between items-center w-full">

          <div class="flex items-center">

            <button title="Pause"
                    data-action="audio#pause"
                    data-audio-target="pauseButton"
                    class="focus:outline-none mr-6">

              <i class="fa fa-pause text-lg"></i>

            </button>

            <button title="Play"
                    data-action="audio#play"
                    data-audio-target="playButton"
                    class="focus:outline-none mr-6 hidden">

              <i class="fa fa-play text-lg"></i>

            </button>


            <button title="Stop"
                    data-action="player#stop"
                    class="focus:outline-none">

              <i class="fa fa-stop text-lg"></i>
            </button>

          </div>

          <div class="flex items-center">
            <button title="Skip back 15 seconds"
                    data-action="audio#skipBack"
                    class="focus:outline-none mr-6">

              <i class="fa fa-undo text-lg"></i>

            </button>
            <button title="Skip forward 15 seconds"
                    data-action="audio#skipForward"
                    class="focus:outline-none mr-6">

              <i class="fa fa-redo text-lg"></i>

            </button>



          </div>

        </div>
      </div>

      <div class="flex items-center w-full justify-between">
        <div class="h-2 mx-auto bg-gray-300 rounded-full w-full flex items-center cursor-pointer"
             title="0">
          <div class="w-4 h-4 rounded-full absolute border shadow-xl bg-blue-800"
               data-audio-target="indicator"
               style="z-index: 12;"></div>
          <div class="h-2 relative rounded-l flex items-center justify-end bg-blue-800"
               style="width: 0%;"
               data-audio-target="progress"></div>
          <div class="h-2 rounded-r relative bg-blue-500"
               data-audio-target="buffer"
               style="width: 0%;"></div>
        </div>
        <div class="w-24 text-right tracking-tighter"
             data-audio-target="counter"></div>
      </div>
    </div>
  </div>
</div>
{% endwith %}
{% endif %}
